<!DOCTYPE HTML>
<html lang="en"> 
<head>
    <meta charset="utf-8"> 
    <title>Pathways: The Mind</title>
    <link rel="stylesheet" type="text/css" href="_assets/css/styles.css">
    
    <script type="text/javascript">
    WebFontConfig = { fontdeck: { id: '44200' } };

    (function() {
      var wf = document.createElement('script');
      wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
      wf.type = 'text/javascript';
      wf.async = 'true';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(wf, s);
    })();
    </script>
</head>
<body>

    <main role="main">

        <div class="start">
            <div class="text">
                <p class="scene-set">
                    <span>Paris 1778</span>
                    <b>The Story of Mesmer</b> 
                </p>
                <h1>Can the mind heal the body?</h1>
                <p class="intro-text">Mesmer arrives in Paris in 1778 and his ‘magnetic’ therapy is a sensation.</p>
                <p class="intro-text">In his salons, or séances, a mysterious ‘magnetic fluid’, directed by magnetised rods, flows around the participants. They twitch, writhe, speak in tongues, collapse in violent convulsions. Patients are cured in their hundreds - of paralysis, epilepsy, toothache, stomach cramps, even lifelong blindness.  He can treat thirty people at a time in his baquets: tubs filled with iron filings and magnetised water in which patients sit and hold hands while the fluid circulates.</p>
            </div>
        </div>

        <!-- Title Screen -->
        <div class="title-screen">
            <audio class="audio-player" src="/_assets/audio/crystal.mp3"></audio>
            <div class="audio-icon"></div>

            <p class="title">Mesmer’s Salon</p>

            <div class="crop-zoom">
                <div class="tap-target" data-crop="mesmer"></div>
            </div>
        </div>

        <!-- Nonsense -->
        <div class="scrolly-nonsense">

            <div class="inner">
                <header>
                    <h2>Animal Magnetism</h2>
                    <p>Mesmer claimed that he had discovered a new force in nature, which he named ‘animal magnetism’: …a universally distributed fluid, so continuous as to admit of no vacuum, incomparably rarefied, and by its nature able to receive, propagate and communicate all motion’</p>
                </header>
                
                <div class="weird-man">
                    <img src="/_assets/img/mesmer-dude.png">
                </div>

                <div class="image-block image1">
                    <img src="/_assets/img/am-1.jpg">
                    <p>Animal magnetism was the energy that permeated all living things. Mesmer  manipulated it by the power of his mind. He had learned to do this by passing his hands  over the bodies of his patients, to remove the blockages in  the magnetic fluid that were causing their illnesses.</p>
                </div>
                <div class="image-block image2">
                    <img src="/_assets/img/am-2.jpg">
                    <p>Then he had discovered that the fluid could be powerfully directed by magnets and metal rods, which attracted the fluid around the body.  He experimented with shaped magnets and found that each  had different effects.</p>
                </div>
                <div class="image-block image3">
                    <img src="/_assets/img/am-3.jpg">
                    <p>As his salons became more crowded, he invented the baquet:  a tub filled with iron filings and magnetised water, in which up to thirty patients could sit and hold hands while the fluid circulated through them.</p>
                </div>
            </div>

        </div>

        <!-- Modal -->
        <div class="tile-modal">

            <div class="row">
                <div class="cell"><div class="pane pane1" data-crop="img1"></div></div>
                <!-- <div class="cell"><div class="pane pane2" data-crop="img2"></div></div> -->
                <div class="cell"><div class="pane pane3" data-crop="img3"></div></div>
                <div class="cell"><div class="pane pane4" data-crop="img4"></div></div>
            </div>

        </div>

        <div class="conclusion">
            <header>
                <h2>The Committee investigates</h2>
                <p>In 1784 an Academy of Sciences committee is convened, led by Benjamin Franklin. They begin by trying magnetic cures on themselves. Some of them feel mild twinges, but nothing like the mass frenzy generated at Mesmer’s salons.</p>
                <p>They proceed to blind testing of patients, and discover that Mesmer’s subjects can’t tell when magnetised objects have been swapped with non-magnetised ones.</p>
                <p><strong>They conclude:</strong>‘There is no proof of the existence of the Animal Magnetic fluid…the imagination without the aid of Magnetism can produce convulsions, but Magnetism without the imagination can produce nothing.’</p>
            </header>

            <div class="video-popup">
                <a class="play-video talkinghead" data-width="640" data-height="360" title="" href="//www.youtube.com/embed/Zl6xwuBJVIY">Play Video</a>
            </div>

            <div class="button"></div>

            <div class="gap">
                <div class="inner clearfix">
                    <ul>
                        <li><a href="#">Stuff!</a></li>
                        <li><a href="#">Help me!</a></li>
                    </ul>

                    <ul>
                        <li><a href="#">Make it stop!</a></li>
                    </ul>
                </div>
            </div><!-- end Gap -->
        </div>

        <div class="new-module">
            <img src="/_assets/img/sigmund-innit.jpg"/>
        </div>
        
    </main>

    <script src="/_assets/js/lib/jquery-2.1.0.min.js"></script>
    <script src="/_assets/js/lib/hammer.min.js"></script>

    <script src="/_assets/js/lib/greensock/TweenMax.min.js"></script>
    <script src="/_assets/js/lib/jquery.scrollmagic.js"></script>
    
    <script>

        var controller;

        $(document).ready(function() {

            controller = new ScrollMagic();

            // build scene
            // var scene = new ScrollScene({triggerElement: ".title", duration: 600})
            //                 .setPin(".title")
            //                 .addTo(controller);

            var $window = $(window),
                $start  = $('.start'),
                $title  = $('.title'),
                $text   = $start.find('.text').first(),
                scrollY = 0;

            window.addEventListener('scroll', parallaxAllTheThings, false);
            window.addEventListener('resize', resizeAllTheThings, false);

            function parallaxAllTheThings() {
                scrollY = window.scrollY;

                if( scrollY > 0 && scrollY < (window.outerHeight + 30) ) {
                    $text.css('-webkit-transform', 'translate3d(0,'+ -(scrollY / 2) +'px,0)');
                }

                if( scrollY > 2000 ) {
                    $title.fadeOut(400);
                }
                else
                    $title.fadeIn(400);
            }

            function resizeAllTheThings() {
                $('.start').css('height', $window.height());
            }
        

            resizeAllTheThings();

            /** Audio **/
            var $player     = document.querySelector('.audio-player'),
                playing     = false;

            $('.audio-icon').on('click', function() {
                if( playing ) {
                    $player.pause();
                    $('.audio-icon').removeClass('active');
                    playing = false;
                }
                else {
                    $player.play();
                    $('.audio-icon').addClass('active');
                    playing = true;
                }
            });
        });
    </script>

    <!-- Crop zoom -->
    <script>
        
        $(document).ready(function() {

            var $image          = $('.crop-zoom'),
                image_top       = $image.offset().top,
                image_height    = $(window).height();

            $image.css({ width: $(window).width(), height: $(window).height() });

            function onResize(e) {
                $image.css({ width: $(window).width(), height: $(window).height() });
            }
            
            function onScroll(e) {

                // slight buffer in case user does not scroll far enough
                if( window.scrollY > (image_top - 60) ) {
                    if( !$('.tap-target').hasClass('animate') )
                        $('.tap-target').addClass('animate');
                }

                if( window.scrollY >= image_top && window.scrollY <= ($image.parent().next().offset().top - image_height) ) {
                    $image.css( { position: 'fixed', top: 0 } );
                }
                else {
                    $image.css( { position: 'static', top: 'auto' } );
                }
            }


            // Tap targets
            $('.tap-target').each(function() {
                var $target = $(this),
                    key     = $target.data('crop'),
                    image   = '/_assets/img/'+ db[key]['image'],
                    text    = db[key]['text'],
                    img     = new Image();

                img.src = image;

                var ratio = img.width / img.height;

                // Set up the tap on the target.
                Hammer( $target.get(0) ).on('tap', function(e) {
                    e.gesture.preventDefault();

                    var $popup,
                        $image_crop,
                        $text,
                        $overlay;

                    // create popup in memory
                    $popup      = $('<div/>').addClass('popup');
                    $image_crop = $(img).addClass('image-crop');
                    $text       = $('<div/>').addClass('text').html(text);

                    $popup.append( $image_crop );
                    $popup.append( $text );

                    $overlay = $('<div/>').addClass('overlay').css('height', $(window).height() );

                    $overlay.append($popup);
                    $('body').append( $overlay );

                    // depress the main image into the page a bit.
                    $image.addClass('depress');

                    $image_crop.css( { top: ($target.offset().top - window.scrollY) + 10, left: $target.offset().left + 10, height: $target.height() - 10 } );

                    $overlay.show();

                    var width   = 'auto',
                        height  = 'auto';

                    if( window.innerWidth < 900 ) {
                        width = '40%';
                    }
                    else {
                        height = $(window).height() - 60;
                    }

                    $image_crop.animate({
                        top:    15,
                        width: width,
                        height: height,
                        opacity: 1
                    }, 500, 'swing', function() { $text.css( { top: 15, left: ($image_crop.offset().left + $image_crop.width() + 40) } ).addClass('show'); });

                    $overlay.css('background-color', 'rgba(0,0,0,0.8)');

                    $overlay.on('click', function() {
                        this.addEventListener('transitionend', function() { $(this).remove() }, false);
                        $(this).css('opacity', 0);
                        $image.removeClass('depress');
                    });

                    window.addEventListener('resize', function() {
                        $overlay.css('height', $(window).height() );
                        
                        if( window.innerWidth < 900 ) {
                            $image_crop.css('height', 'auto');
                            $image_crop.css('width',  '40%');
                        }
                        else {
                            $image_crop.css('width', 'auto');
                            $image_crop.css('height', $(window).height() - 60 );
                        }

                        $text.css( { left: ($image_crop.offset().left + $image_crop.width() + 40) } );
                    }, false);

                });
            });

            // Events
            window.addEventListener('resize', onResize, false);
            window.addEventListener('scroll', onScroll, false);
        
        });

    </script>

    <!-- Scrolly Nonsense -->
    <script>
        function nonsense() {

            new ScrollScene({triggerElement: ".weird-man", duration: 1200})
                        .setPin(".weird-man")
                        .offset(200)
                        .addTo(controller);

            $('.image-block').each(function() {
                var $this   = $(this),
                    $img    = $this.find('img').first(),
                    $p      = $this.find('p').first();

                $p.css({
                    top: 10,
                    left: ( $img.offset().left - $img.offsetParent().offset().left + $img.width() + 40 ),
                    'text-align': 'left',
                    opacity: 0,
                    '-webkit-transform': 'translate3d(180px,280px,0)'
                });

                var tween = TweenMax.to($p, 0.5, {"opacity": "1", "-webkit-transform": "translate3d(0,0,0)"});

                // build scene
                new ScrollScene({triggerElement: $this, duration: 200})
                            .setTween(tween)
                            .offset(-50)
                            .addTo(controller);
            });
        }

        window.addEventListener('load', nonsense, false);
    </script>

    <!-- Tile Modal -->
    <script>

        function panes() {

            // Tap targets
            $('.pane').each(function() {
                var $target         = $(this),
                    key             = $target.data('crop'),
                    image           = '/_assets/img/'+ db[key]['image'],
                    img             = new Image,
                    target_height   = $target.height(),
                    ratio;

                img.src = image;

                img.onload = function() {
                    ratio = img.width / img.height;
                }

                // Set up the tap on the target.
                Hammer( $target.get(0) ).on('tap', function(e) {
                    e.gesture.preventDefault();

                    var $popup,
                        $image_crop,
                        $overlay;

                    // create popup in memory
                    $popup      = $('<div/>').addClass('popup');
                    $image_crop = $(img).addClass('image-crop');

                    $popup.append( $image_crop );

                    $overlay = $('<div/>').addClass('overlay').css('height', $(window).height() );

                    $overlay.append($popup);
                    $('body').append( $overlay );

                    // depress the main image into the page a bit.
                    $target.addClass('depress');

                    // place the image in the center of the target.
                    var small_width = (target_height - 10) * ratio;
                    $image_crop.css( { top: ($target.offset().top - window.scrollY) + 10, left: ($target.offset().left + ($target.width() / 2) - (small_width / 2)), height: target_height - 10 } );

                    $overlay.show();

                    var width   = 'auto',
                        height  = 'auto';

                    if( window.innerWidth < 900 ) {
                        width = '40%';
                    }
                    else {
                        height = $(window).height() - 60;
                    }

                    var c_width = parseInt( height * ratio );

                    $image_crop.animate({
                        top:    15,
                        left:   ($(window).width() / 2) - (c_width / 2),
                        width:  width,
                        height: height,
                        opacity: 1
                    }, 500, 'swing', function() {
                        $overlay.css('background-color', 'rgba(0,0,0,0.8)');
                    });

                    $overlay.on('click', function() {
                        $overlay.get(0).addEventListener('transitionend', function() {
                           $(this).remove();
                       }, false);
                        $overlay.css('opacity', 0);
                        $target.removeClass('depress');
                    });

                    window.addEventListener('resize', function() {
                        $overlay.css('height', $(window).height() );
                        
                        if( window.innerWidth < 900 ) {
                            $image_crop.css('height', 'auto');
                            $image_crop.css('width',  '40%');
                        }
                        else {
                            $image_crop.css('width', 'auto');
                            $image_crop.css('height', $(window).height() - 60 );
                        }
                    }, false);

                });
            });
        
        }

        window.addEventListener('load', panes, false);

    </script>

    <!-- Library layer -->
    <script>
        var state = 'closed';

        function positionCenter($elm) {
            var width   = $elm.width(),
                height  = $elm.height(),
                $window = $(window);

            $elm.css({ position: 'absolute', top: ($window.height() / 2) - (height / 2), left: ($window.width() / 2) - (width / 2) });
        }

        $(document).ready(function() {

            $('.conclusion').on('click', '.play-video', function() {

                var $this       = $(this),
                    $window     = $(window),
                    $overlay    = $('<div/>').addClass('overlay').css('height', $window.height() ),
                    $iframe     = $('<iframe/>').attr('src', $this.attr('href'));

                if( $this.data('width') )
                    $iframe.attr('width', $this.data('width') );

                if( $this.data('height') )
                    $iframe.attr('height', $this.data('height') );

                $overlay.append($iframe);
                $('body').append($overlay);

                $overlay.show().css('background-color', 'rgba(0,0,0,0.8)');
                
                positionCenter($iframe);

                setTimeout(function() {
                    $iframe.addClass('animate');
                }, 400);

                $overlay.on('click', function() {
                    this.addEventListener('transitionend', function() { $(this).remove() }, false);
                    $overlay.css('opacity', 0);
                })

                window.addEventListener('resize', function() { $overlay.css('height', $window.height() )}, false)

                return false;
            });

            $('.conclusion').on('click', '.button', function() {
                if( state == 'closed' ) {
                    $('.conclusion .gap').css('height', 250);
                    state = 'open';
                }
                else {
                    $('.conclusion .gap').css('height', 0);
                    state = 'closed';
                }
            });
        });

    </script>

    <script>
        var db = {
            'mesmer': {
                'image': 'mesmer-crop.jpg',
                'text': 'Mesmer claimed that he had discovered a new force in nature, which he named ‘animal magnetism’: …a universally distributed fluid, so continuous as to admit of no vacuum, incomparably rarefied, and by its nature able to receive, propagate and communicate all motion’'
            },
            'img1': {
                'image': '2.jpg',
            },
            'img2': {
                'image': '4.jpg',
            },
            'img3': {
                'image': '3.jpg',
            },
            'img4': {
                'image': '1.jpg',
            },
        }
    </script>

</body>
</html>
