function _(a){return document.querySelector(a)}function initCanvas(){canvas=document.getElementById("canvas"),images=images||{};var a=new createjs.LoadQueue(!1);a.addEventListener("fileload",handleFileLoad),a.addEventListener("complete",handleComplete),a.loadManifest(lib.properties.manifest)}function handleFileLoad(a){"image"==a.item.type&&(images[a.item.id]=a.result)}function handleComplete(){var a=new lib.tree2;stage=new createjs.Stage(canvas),stage.addChild(a),stage.update(),createjs.Ticker.setFPS(lib.properties.fps),Modernizr.touch&&createjs.Ticker.addEventListener("tick",stage)}function parallaxContentLoad(){var a=window.pageYOffset,b=.5/(Pathways.panelHeight/2);if($parallaxContent){if(a>Pathways.panelHeight)return void $parallaxContent.css("display","none");$parallaxContent.css({display:"block",opacity:1-b*a,transform:Modernizr.csstransforms3d?"translate3d(0,"+a/2+"px,0)":"translate(0,"+a/2+"px)"})}}function parallaxContentUnload(){$parallaxContent.removeAttr("style")}function parallaxLadyLoad(){var a=window.pageYOffset,b=$(".falling-lady").first();if(b){if(a>Pathways.panelHeight)return;b.css({transform:Modernizr.csstransforms3d?"translate3d(0,"+.7*a+"px,0)":"translate(0,"+.7*a+"px)"})}}function parallaxLadyUnload(){$parallaxLady.removeAttr("style")}function onScrollUnload(){$parallaxContent&&(parallaxContentUnload(),window.removeEventListener("scroll",parallaxContentLoad,!1)),$parallaxLady&&(parallaxLadyUnload(),window.addEventListener("scroll",parallaxLadyLoad,!1))}function onScrollLoad(a){function b(){f.css({position:"fixed",height:a.panelHeight,transform:"translate(0,"+a.panelHeight+"px)"})}function c(a,b){if(a)var c=JSON.parse(a);return c&&c[b]||null}var d=$(".sequence"),e=new ScrollMagic({refreshInterval:500}),f=$(".black-strip");b(),window.addEventListener("resize",b);var g=new Array,h=0;if($parallaxContent&&window.addEventListener("scroll",parallaxContentLoad,!1),$parallaxLady&&window.addEventListener("scroll",parallaxLadyLoad,!1),_(".sequence")){{var i=d.find(".bg-container"),j=d.find(".panel").first();d.find(".panel").last()}g[h++]=new ScrollScene({triggerElement:d,triggerHook:"top",duration:function(){return d.height()-Pathways.panelHeight}}).on("enter",function(a){i.css({display:"block"}),"FORWARD"==a.scrollDirection&&(i.css({position:"fixed",display:"none",opacity:0}),j.find(".bg-container").css({display:"block",opacity:1})),"REVERSE"==a.scrollDirection&&i.css({position:"fixed"})}).on("leave",function(){i.css({position:"absolute",display:"block"})})}$('[data-component="gallery"]').hide(),$('[data-component="quiz"]').hide();var k=document.querySelectorAll(".sequence .panel").length,l=0;return $(".sequence .panel").each(function(){function b(){return i.outerHeight()}function d(){return a.panelHeight/4}function e(a){return function(){return.75*i.outerHeight()-a}}function f(){var a=i.outerHeight();return l==k?.75*a:a-300}var i=$(this),j=i.attr("id"),m=i.find(".bg-container"),n=$('[data-panel="'+j+'"]').first(),o=i.find('[data-component="gallery"]'),p=i.find('[data-component="quiz"]'),q=i.find('[data-audio="panel"]'),r=i.find('[data-video="panel"]'),s=TweenMax.to(m,1,{opacity:1});if(l+=1,g[h++]=new ScrollScene({triggerElement:i,duration:d}).on("enter",function(){m.css("display","block")}).on("leave",function(){m.css("display","block")}).setTween(s),o.length){var t=c(o.attr("data-config"),"offset_height")||0;g[h++]=new ScrollScene({triggerElement:i,triggerHook:"top",duration:e(t),offset:t}).on("enter",function(){o.css({position:"fixed",display:"block"}),setTimeout(function(){o.addClass("active")},50)}).on("leave",function(){o.css({position:"absolute",display:"none"}),setTimeout(function(){o.removeClass("active")},50)})}if(p.length){var u=c(p.attr("data-config"),"offset_height")||0;g[h++]=new ScrollScene({triggerElement:i,triggerHook:"top",duration:e(u),offset:u}).on("enter",function(){p.css({position:"fixed",display:"block"}),setTimeout(function(){p.addClass("active")},50)}).on("leave",function(){p.css({position:"absolute",display:"none"}),setTimeout(function(){p.removeClass("active")},50)})}if(n.length&&(n.css("transform","translate("+n.outerWidth()+"px, "+(n.outerHeight()-60)+"px)"),g[h++]=new ScrollScene({triggerElement:i,duration:f,offset:100}).on("enter",function(){n.css({position:"fixed",display:"block"})}).on("leave",function(){n.css({position:"absolute",display:"none"})})),q.length){var v=q.first();g[h++]=new ScrollScene({triggerElement:i,duration:b}).on("enter",function(){a.loadPanelAudio(v[0])}).on("leave",function(){a.unloadPanelAudio(v[0])})}if(r.length){var w=r.first(),x=w.attr("data-config"),y=c(x,"initTime")||0,z=c(x,"muteGlobal")||!0;g[h++]=new ScrollScene({triggerElement:i,duration:b}).on("enter",function(){a.autoPlayVideoOnEnter(w[0],y,z)}).on("leave",function(){a.autoStopVideoOnLeave(w[0],y,z)})}var A=a.Utils.toTitleCase(j);null!=a.Scene[A]&&a.Scene[A]("#"+j)}),g.forEach(function(a){a.addTo(e)}),a.Scenes.forEach(function(a){a.addTo(e)}),e}function onPathwaysLoad(){function a(a,b,c,d){var e,f=a.getElementsByTagName(b)[0];a.getElementById(c)||(e=a.createElement(b),e.id=c,e.async=1,e.src=d,f.parentNode.insertBefore(e,f))}window.___gcfg={parsetags:"onload"},a(document,"script","facebook-jssdk","//connect.facebook.net/en_GB/sdk.js#xfbml=1&appId=1494497634145827&version=v2.0"),a(document,"script","pth-ga-api","//apis.google.com/js/platform.js"),a(document,"script","pth-pin-api","//assets.pinterest.com/js/pinit.js"),a(document,"script","pth-twt-api","//platform.twitter.com/widgets.js")}function Carousel(a){function b(){var a=0,b=window.innerHeight;m=[];for(var c=0;c<j.length;c++){var d=b/n[c];j[c].style.width=d+"px",m.push(d),a+=d}i.width(a),r=window.innerWidth/2,o=parseInt(a/j.length),i.css("height",b),g.height(b),h.height(b),e.showPane(q,!1)}function c(a,b){i.removeClass("animate"),b&&i.addClass("animate"),Modernizr.csstransforms3d?i.css("transform","translate3d("+a+"px,0,0)"):i.css("transform","translate("+a+"px,0)")}function d(a){switch(a.gesture.preventDefault(),a.type){case"dragright":case"dragleft":for(var b=0,d=0;q>d;d++)b-=m[d];b+=r-m[q]/2;var f=100/440*a.gesture.deltaX/p;(0==q&&"right"==a.gesture.direction||q==p-1&&"left"==a.gesture.direction)&&(f*=.4),c(a.gesture.deltaX+b);break;case"swipeleft":e.next(),a.gesture.stopDetect();break;case"swiperight":e.prev(),a.gesture.stopDetect();break;case"release":Math.abs(a.gesture.deltaX)>o/10*3?"right"==a.gesture.direction?e.prev():e.next():e.showPane(q,!0)}}var e=this,f=(document.querySelector(a),$(a)),g=null,h=null,i=null,j=null,k=imageDB.images,l=imageDB.location,m=[],n=[],o=0,p=0,q=0,r=window.innerWidth/2;this.init=function(){i=$("<ul/>"),i.height(window.innerHeight),f.append(i);var a=[].concat(k),c=a[0];s(c,function(){u(),j=f.find("li"),p=j.length,i.css("transform","translate("+(r-m[0]/2)+"px,0)"),b(),a.shift(),t(a)}),$(window).on("load resize orientationchange",function(){b()})};var s=function(a,b){var c,d=new Image,e=$("<li/>");d.src="/_assets/img/"+l+a.image+".jpg",d.onload=function(){if(c=$(d),c.css("height","100%"),e.append(c),a.text){var f=$("<div>"+a.text+"</div>").addClass("text");e.append(f)}var g=d.naturalWidth,h=d.naturalHeight,j=h/g,k=window.innerHeight/j;m.push(k),n.push(j),e.width(k),i.append(e);var l=m.reduce(function(a,b){return a+b});i.width(l),b&&b.call()}},t=function(a){a.length&&s(a[0],function(){j=f.find("li"),p=j.length,b(),a.shift(),t(a)})},u=function(){g=$("<div/>"),h=$("<div/>"),g.addClass("prev disabled"),h.addClass("next"),g.css({left:0,height:window.innerHeight+"px"}),h.css({right:0,height:window.innerHeight+"px"}),f.append(g),f.append(h),new Hammer(g[0]).on("tap",function(){e.prev()}),new Hammer(h[0]).on("tap",function(){e.next()})};this.showPane=function(a,b){var d=0;a=Math.max(0,Math.min(a,p-1)),q=a;for(var e=0;a>e;e++)d-=m[e];d+=r-m[a]/2,j.css("opacity",.4),j.get(q).style.opacity=1,c(d,b),a>0?g.removeClass("disabled"):g.addClass("disabled"),a>=p-1?h.addClass("disabled"):h.removeClass("disabled")},this.next=function(){return this.showPane(q+1,!0)},this.prev=function(){return this.showPane(q-1,!0)},new Hammer(f[0],{drag_lock_to_axis:!0}).on("release dragleft dragright swipeleft swiperight",d)}function InfiniteCanvas(a){function b(a){var b=a.outerWidth(),d=a.outerHeight(),e=a.position().top,f=a.position().left,m=(k-b)/2,n=(l-d)/2,o=-f+m,p=-e+n;o>0&&(o=0),Math.abs(o-k)>g&&(o=-(g-k)),p>0&&(p=0),Math.abs(p-l)>h&&(p=-(h-l)),c(o,p,!0),i=o,j=p}function c(a,b,c){f.removeClass("animate"),c&&f.addClass("animate"),Modernizr.csstransforms3d?f.css("transform","translate3d("+a+"px, "+b+"px ,0)"):f.css("transform","translate("+a+"px,"+b+"px)")}function d(a){switch(a.gesture.preventDefault(),a.type){case"drag":c(a.gesture.deltaX+i,a.gesture.deltaY+j);break;case"release":i+=a.gesture.deltaX,j+=a.gesture.deltaY,i>0&&(c(0,j,!0),i=0),Math.abs(i-k)>g&&(c(-(g-k),j,!0),i=-(g-k)),j>0&&(c(i,0,!0),j=0),Math.abs(j-l)>h&&(c(i,-(h-l),!0),j=-(h-l))}}var e=a,f=$(a),g=0,h=0,i=0,j=0,k=window.innerWidth,l=window.innerHeight;this.init=function(){g=f.outerWidth(),h=f.outerHeight(),b($('[data-chapter="1"]',f)),f.on("click",".prev, .next",function(a){var c=$(this),d=$(a.target),e=c.parents(".text-panel").data("chapter");if(d.hasClass("prev")){var g=$('[data-chapter="'+(e-1)+'"]',f);g.length&&b(g)}if(d.hasClass("next")){var g=$('[data-chapter="'+(e+1)+'"]',f);g.length&&b(g)}a.preventDefault()}),window.addEventListener("resize",function(){k=window.innerWidth,l=window.innerHeight}),this.loadImages()},this.loadImages=function(){console.log("running");for(var a=canvasDB,b=a.length,c=0;b>c;c++){var d=$("<img/>").addClass("image-panel");d.attr("src","/_assets/img/infinite-canvas/infiniteCanvas_"+a[c].id+".jpg"),d.css({left:a[c].pos[0],top:a[c].pos[1]}),f.append(d)}},new Hammer(e,{}).on("release drag",d)}function Modal(a){var b=a;this.init=function(){var a=new Image,c=$('<div class="overlay"></div>'),d=$(a).css("opacity",0),e=$('<div class="close"></div>');a.src=b.attr("data-image"),a.onload=function(){var a=this.width,b=this.height,e=window.innerHeight/2-b/2,f=window.innerWidth/2-a/2;d.css({position:"absolute",top:e,left:f}),c.append(d),d.animate({opacity:1},500)},c.append(e),$("body").append(c),c.css({height:window.outerHeight,"background-color":"rgba(0,0,0,0.9)"}),e.on("click",function(){c.css("opacity",0),setTimeout(function(){c.remove()},600)})}}function Quiz(a){var b,c,d=$(a),e=!1,f=1,g=quiz_db.images,h=quiz_db.questions,i=(quiz_db.questions[f].answers,h.length),j=0,k=5,l=5,m=d.find(".remaining"),n=d.find(".score span"),o=$("<div/>").addClass("timer").css("display","none");this.init=function(){var a=this,b=d.find(".quiz-header-image"),c=$("<img/>").attr("src",g+"/intro.jpg");b.html(c),d.append(o),d.on("click",".quiz-start .button",function(){a.start()}),d.on("click","li",function(b){e||a.validate(b)})},this.start=function(){d.find(".quiz-start").hide(),d.find(".status-bar").show(),d.find(".quiz-playground").show(),this.loadLevel()},this.getCurrentQuestion=function(){return h[f-1]},this.loadLevel=function(){var a=this,b=this.getCurrentQuestion(),e=$("<img/>").attr("src",g+"/"+b.image),f="<ul>";d.find(".image").html(e),d.find(".question").html(b.title);for(var h=0;h<b.answers.length;h++)f+="<li>"+b.answers[h]+"</li>";f+="</ul>",d.find(".answers").html(f),this.updateScore(),this.updateQuestionsRemaining(),c=setTimeout(function(){a.startTimer()},1e3*k)},this.validate=function(a){var b=this,c=this.getCurrentQuestion(),f=!1;this.stopTimer(),d.find("li").index($(a.currentTarget))==c.correct-1&&(f=!0),f?(e=!0,this.showCorrect($(a.currentTarget)),j++,this.updateScore()):this.showError($(a.currentTarget)),setTimeout(function(){e=!1,b.stopTimer(),b.nextQuestion($(a.currentTarget))},2e3)},this.nextQuestion=function(){f++,f<=h.length?this.loadLevel():this.finishGame()},this.showCorrect=function(a){a.addClass("correct")},this.showError=function(a){a.addClass("wrong")},this.revealAnswers=function(){var a=this,b=this.getCurrentQuestion(),c=1;d.find(".answers li").each(function(){c==b.correct?a.showCorrect($(this)):a.showError($(this)),c++})},this.updateScore=function(){n.html(j)},this.updateQuestionsRemaining=function(){m.html("<em>"+f+"</em> of <span>"+i+"</span>")},this.startTimer=function(){var a=this,c=l;this.stopTimer();var f=d.find(".quiz-playground .image"),g=d.find(".quiz-playground .image").offset().top-d.find(".quiz-playground").offset().top;o.css({top:g+f.outerHeight()/2-o.height()/2,left:f.outerWidth()/2-o.width()/2}).html(c),o.fadeIn(100),b=setInterval(function(){c>1?o.html(--c):(o.html('<span style="color:red">'+--c+"</span>"),e=!0,a.stopTimer(),a.revealAnswers(),setTimeout(function(){e=!1,o.fadeOut(100),a.nextQuestion()},2e3))},1e3)},this.stopTimer=function(){clearInterval(b),clearTimeout(c),o.fadeOut(100)},this.finishGame=function(){var a=this,b=d.find(".quiz-finish");this.stopTimer(),o.css("display","none"),b.find(".quiz-finish--score").html("<span>"+j+"</span> out of "+i),d.find(".quiz-playground").hide(),b.show(),b.on("click",".play-again",function(){a.restart()})},this.restart=function(){this.stopTimer(),j=0,f=1,d.find(".quiz-finish").hide(),this.start()},this.init()}var Capabilities=function(a){var b={aspectRatio:1900/1050,supportsTouch:!1,innerHeight:0,innerWidth:0,orientation:"landscape",level:0,calcSupportsTouch:function(){return"ontouchstart"in a||a.DocumentTouch&&document instanceof DocumentTouch},calcOrientation:function(){return this.innerWidth/this.innerHeight>1.2?"landscape":"portrait"},calcAspectRatio:function(){return"landscape"===this.orientation?1900/1050:1050/1900},getEnhancementLevel:function(){var b=0;return a.innerWidth>=480&&(b=1),a.innerWidth>=768&&this.supportsTouch&&(b=2),a.innerWidth>=960&&this.supportsTouch&&(b=3),a.innerWidth>=768&&!this.supportsTouch&&(b=4),b},getDisplaySettings:function(){this.innerWidth=a.innerWidth,this.innerHeight=a.innerHeight,this.orientation=this.calcOrientation(),this.supportsTouch=this.calcSupportsTouch(),this.level=this.getEnhancementLevel()},init:function(){a.addEventListener("resize",this.getDisplaySettings.bind(this),!1)}};return b.getDisplaySettings(),b.init(),b}(this,jQuery),Pathways=function(a,b,c,d){"use strict";function e(a){var b=c.innerHeight<X?X:c.innerHeight;return $=a>b?!0:!1,b}function f(a){return a=a.replace(/-/g," ").replace(/_/g," "),a=a.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1)}),a.replace(/\W/g,"")}function g(a){var b=a.width(),d=a.height(),e=c.innerHeight/2-d/2,f=c.innerWidth/2-b/2;a.css({position:"absolute",top:e,left:f})}function h(a){var b=d(a),c=b.attr("data-config"),e=b.find(".bg-container").get(0),f={};return c&&(f=JSON.parse(c)),{elem:a,config:f,bg:e}}function i(a){var b=d(a),c=[];return b.each(function(a,b){c.push(h(b))}),c}function j(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].config.background.preserve_ratio;d&&b.push(a[c])}return b}function k(a){var b=[],c=d("[data-component]");c.each(function(c,e){var g=d(e).attr("data-component");if(g){var h=f(g);null==a[h]||-1!=b.indexOf(h)&&1!=a[h].alwaysLoad||(a[h](e),b.push(h)),null==a[h]&&console.warn("Could not load the necessary component: "+h)}})}function l(a,b){d(a).css("height",parseInt(b,10)+"px")}function m(a){d(a).css("height","")}function n(a,b){var d=c.innerWidth/c.aspectRatio,e=["-moz-","-webkit-",""],f=parseInt((b-d)/2,10);if(b>d)for(var g=0;g<e.length;g++)a.style[e[g]+"transform"]="translate(0, "+f+"px)"}function o(a){S&&m(S);for(var b=0;b<a.length;b++){var c=a[b].elem,e=a[b].bg;d(c).removeAttr("style"),d(e).removeAttr("style");var f=a[b].config.background.preserve_ratio;f&&d(c).children().each(function(a,b){d(b).removeAttr("style")})}}function p(a,b){var d=a.elem;m(d);var e=a.config,f=a.bg,g=d.offsetHeight,h=e?c.supportsTouch||!e.offset_height?0:e.offset_height:0,i=b>g?b:g;(i!==g||h)&&l(d,i+h),f&&l(f,b)}function q(a,b){var d=c.innerWidth/c.aspectRatio;l(b,d),n(b,_.panelHeight)}function r(a,b){a&&l(a,_.panelHeight);for(var c=0;c<b.length;c++){p(b[c],_.panelHeight);var e=b[c].config.background.preserve_ratio;e&&d(b[c].elem).children().each(q)}}function s(){S&&d(S).removeAttr("style"),d(".comic-panel").removeAttr("style");for(var a=0;a<T.length;a++){var b=T[a],c=d(b.bg),e=d(b.elem),f=e.attr("id"),g=e.find('[data-panel="'+f+'"]').first(),h=e.find('[data-component="gallery"]'),i=e.find('[data-component="quiz"]');c.removeAttr("style"),g.removeAttr("style"),h.removeAttr("style"),i.removeAttr("style")}}function t(a){var b=d(a);return b.css("display","block"),b.unbind("click"),b.on("click",function(a){return u(d(this).hasClass("active")?!1:!0),A(),a.preventDefault(),!1}),b}function u(a){W=a,d("video, audio").each(function(){this.muted=W})}function v(a,b){for(var d=[],e=0;e<a.length;e++){var f=a[e].elem,g=f.querySelector(b);g&&(g.addEventListener("volumechange",function(){this.muted!=W&&(u(this.muted),A())}),g.addEventListener("error",function(){console.warn("Video loading error for ",g.src)}),!c.level>=_.MIN_SCROLL_LEVEL?g.setAttribute("preload","auto"):(g.setAttribute("preload","metadata"),g.controls=!0),d.push(g))}return d}function w(a){for(var b,c=0,d=a.length;d>c;c++)if(b=a[c]){var e=b.textTracks;if(e.length)for(var f=0,g=e.length;g>f;f++){var h=e[f];h&&(h.mode="hidden")}}}function x(b,c,e){var f=1e3,g=b&&!c;return b===c?void(e&&a.setTimeout(e,f)):(b&&"undefined"!=typeof b&&(d(b).stop(!1,!0),d(b).animate({volume:0},{duration:f,complete:function(){this.pause(),g&&e&&(e(),e=null)}})),void(c&&"undefined"!=typeof c&&(d(c).stop(!1,!0),c.volume=0,c.muted=W,c.play(),d(c).animate({volume:1},{duration:f,complete:function(){!g&&e&&(e(),e=null)}}))))}function y(a){x(P,a)}function z(a){x(a,P)}function A(){W?O.addClass("active"):O.removeClass("active")}function B(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d].elem,f=e.querySelector(b);f&&c.push(c)}return c}function C(a){var b=d(a).get(0);return b&&x(null,b),b}function D(a,b){var c=null;return(a||"undefined"==typeof a)&&(c=b),c}function E(a,b,c){b=b||0;var d=D(c,P);a&&(0!==a.readyState&&(a.currentTime=b),x(d,a))}function F(a,b,c){b=b||0;var d=D(c,P);a&&x(a,d,function(){0!==a.readyState&&(a.currentTime=b)})}function G(a){return b(a+" video")}function H(a){return d(a+" audio").first()[0]}function I(){O=t(".mute")}function J(a){Q=v(a,"video"),w(Q)}function K(a){P=C('[data-audio="global"]'),R=B(a,'[data-audio="panel"]')}function L(){c.level<_.MIN_COMPONENT_LEVEL?(o(T),ab=!0):c.level>=_.MIN_COMPONENT_LEVEL&&c.level<_.MIN_SCROLL_LEVEL?(r(null,U),ab=!1):c.level>=_.MIN_SCROLL_LEVEL&&(r(S,T),ab=!1)}function M(a,b){_.panelHeight=e(_.panelHeight),Y?c.level<_.MIN_SCROLL_LEVEL&&(V.destroy(!0),s(),b(_),d("audio, video").each(function(){this.muted=!0}),O.hide(),Y=!1):c.level>=_.MIN_SCROLL_LEVEL&&(V=a(_),I(),K(T),Y=!0),Z?c.level<_.MIN_COMPONENT_LEVEL:c.level>=_.MIN_COMPONENT_LEVEL&&(k(_),Z=!0)}function N(b,c,e){S=d(".start").get(0),T=i(".panel"),U=j(T),L(),a.addEventListener("resize",function(){L(),M(c,e)}),a.addEventListener("load",function(){L(),M(c,e),J(T),b(_)})}var O,P,Q,R,S,T,U,V,W=(a.document,!1),X=550,Y=!1,Z=!1,$=!1,_={MIN_COMPONENT_LEVEL:2,MIN_SCROLL_LEVEL:4,panelHeight:e(X),getPanelHeight:function(){return this.panelHeight}},ab=!1;return _.init=N,_.getPanelAudioElement=H,_.getPanelVideoElement=G,_.autoPlayVideoOnEnter=E,_.autoStopVideoOnLeave=F,_.loadPanelAudio=y,_.unloadPanelAudio=z,_.translatePanelElem=n,_.Scene={},_.Scenes=[],_.Utils={toTitleCase:f,positionCenter:g},_}(this,_,Capabilities,jQuery);!function(a){var b=a(".global-navigation"),c=b.find(".handle"),d="open",e=b.outerHeight(),f=c.outerHeight();b.on("click",".handle",function(){e=b.outerHeight(),"open"==d?(b.css("transform","translate(0, "+-(e-f)+"px)"),d="closed"):(b.css("transform","translate(0, 0)"),d="open",a(window).one("scroll",function(){c.trigger("click")}))}),window.addEventListener("resize",function(){e=b.outerHeight(),b.css("transform","translate(0, "+-(e-f)+"px)")}),setTimeout(function(){c.trigger("click")},1e3),a(".comic-quote").on("click",".info-box",function(){var b=a(this),c=b.parent();c.hasClass("active")?c.removeClass("active"):c.addClass("active")}),a(".library-panel").on("click",'[rel="external"]',function(b){var c=a(this);window.open(c.attr("href")),b.preventDefault()})}($);var canvas,stage;window.innerWidth>=768&&initCanvas();var $parallaxContent=$(".start").find(".content").first(),$parallaxLady=$(".start").find(".falling-lady").first();Pathways.init(onPathwaysLoad,onScrollLoad,onScrollUnload),Pathways.AudioPlayer=function(){var a=this,b=$(".audio-player"),c=b.find(".progressed"),d=b.find(".time-left span"),e=!1,f=b.data("src"),g=new Audio(f);b.on("click",".controls",function(){e?(g.pause(),$(this).removeClass("active"),e=!1):(g.play(),$(this).addClass("active"),e=!0)}),g.addEventListener("timeupdate",function(){var b=parseInt(g.duration-g.currentTime);c.css("width",g.currentTime*(100/g.duration)+"%"),d.html(a.secondsToMinutes(b))}),this.secondsToMinutes=function(a){var b=Math.floor(a/60),c=a%60;return 10>c&&(c="0"+c),b+"."+c}},Pathways.Gallery=function(){$('[data-component="gallery"]').on("click",function(){var a=$('<div class="overlay"></div>'),b=$('<div class="close"></div>'),c=$('<div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>');a.css("height",window.innerHeight),$("body").append(a),a.show(),a.css("background-color","rgba(0,0,0,0.8)"),a.append(c),c.css({position:"absolute",top:window.innerHeight/2-12,left:window.innerWidth/2-35}),$("body").addClass("modal-open"),setTimeout(function(){var c=$('<div class="carousel"></div>');a.append(c);var d=new Carousel(".carousel");d.init(),a.append(b)},800),b.on("click",function(){a.css("opacity",0),$("body").removeClass("modal-open"),setTimeout(function(){a.remove()},800)})})},Pathways.CropZoom=function(){var a=$(".crop-zoom"),b="";a.css({position:"absolute",opacity:Modernizr.touch?1:0,width:window.innerWidth,"z-index":10}),window.addEventListener("resize",function(){a.css({width:window.innerWidth})}),a.find(".tap-target").each(function(){var a=$(this),c=a.data("crop");if(!db[c])return void console.warn("No related info was found for this tap target");var d,e=b+db[c].image,f=db[c].title?db[c].title:"",g=db[c].text?db[c].text:"",h=db[c].position?db[c].position:"",i=new Image;i.src=e,d=""!=f?"<h2>"+f+"</h2>":"",d+="<p>"+g+"</p>",Hammer(a.get(0)).on("tap",function(a){a.gesture.preventDefault();var b=$('<div class="overlay"></div>'),c=$('<div class="popup"></div>'),e=$(i).addClass("image-crop"),f=$('<div class="text"></div>'),g=$('<div class="close"></div>');f.html(d),c.append(e),c.append(f),b.append(c),b.append(g),$("body").append(b),b.css("height",window.outerHeight),b.css("background-color","rgba(0,0,0,0.9)"),e.get(0).addEventListener("transitionend",function(){f.css({top:window.innerHeight-f.outerHeight()-15}),"right"==h?f.css("right",40):f.css("left",40),f.addClass("show")}),e.css({top:0,left:0,transform:"translate(0, "+Pathways.panelHeight/4+"px)",opacity:0}),$("body").addClass("modal-open"),setTimeout(function(){e.addClass("animate"),e.css(window.innerHeight>window.innerWidth?{transform:"translate(0, "+(window.innerHeight-e.height())/2+"px)",opacity:1}:{transform:"translate(0, 0)",opacity:1})},50),e.on("click",function(){b.css("opacity",0),$("body").removeClass("modal-open"),setTimeout(function(){b.remove()},600)}),g.on("click",function(){b.css("opacity",0),$("body").removeClass("modal-open"),setTimeout(function(){b.remove()},600)}),window.addEventListener("resize",function(){b.css("height",window.innerHeight),f.css({top:window.innerHeight-f.outerHeight()-15})})})})},Pathways.InfiniteCanvas=function(){$(".infinite-canvas").each(function(){var a=new InfiniteCanvas(this);a.init()})};var canvasDB=[{id:"03",pos:[1220,35]},{id:"05",pos:[1648,35]},{id:"07",pos:[2075,35]},{id:"09",pos:[2397,35]},{id:"12",pos:[4083,37]},{id:"15",pos:[3235,38]},{id:"18",pos:[66,52]},{id:"21",pos:[6704,54]},{id:"24",pos:[5455,68]},{id:"27",pos:[773,113]},{id:"30",pos:[7418,163]},{id:"33",pos:[2765,165]},{id:"36",pos:[3704,231]},{id:"39",pos:[5913,275]},{id:"43",pos:[4836,294]},{id:"46",pos:[1220,366]},{id:"49",pos:[6704,446]},{id:"54",pos:[773,486]},{id:"56",pos:[3387,511]},{id:"58",pos:[2765,512]},{id:"63",pos:[4083,546]},{id:"66",pos:[2311,575]},{id:"69",pos:[2098,576]},{id:"72",pos:[66,670]},{id:"79",pos:[4811,758]},{id:"81",pos:[5359,758]},{id:"83",pos:[3387,790]},{id:"89",pos:[2094,870]},{id:"93",pos:[6704,930]},{id:"96",pos:[773,1078]},{id:"99",pos:[4083,1271]},{id:"101",pos:[228,1300]},{id:"104",pos:[2765,1372]},{id:"107",pos:[5902,1414]},{id:"109",pos:[6192,1414]},{id:"111",pos:[6927,1414]},{id:"113",pos:[7420,1414]},{id:"116",pos:[1266,1527]},{id:"118",pos:[1636,1527]},{id:"123",pos:[805,1608]},{id:"127",pos:[4809,1628]},{id:"130",pos:[5230,1659]},{id:"133",pos:[6927,1746]},{id:"141",pos:[1265,1816]},{id:"144",pos:[1995,1816]},{id:"147",pos:[4324,1816]},{id:"149",pos:[5902,1845]},{id:"151",pos:[6286,1845]},{id:"154",pos:[6668,1846]},{id:"156",pos:[1629,1852]},{id:"159",pos:[7420,1903]},{id:"161",pos:[805,1998]},{id:"168",pos:[5406,2101]},{id:"170",pos:[6286,2101]},{id:"171",pos:[6927,2114]},{id:"172",pos:[1265,2126]},{id:"175",pos:[315,2135]},{id:"178",pos:[4984,2178]},{id:"183",pos:[4226,2212]},{id:"192",pos:[5902,2371]},{id:"194",pos:[6414,2371]},{id:"196",pos:[805,2388]},{id:"199",pos:[1729,2389]},{id:"201",pos:[2164,2389]},{id:"203",pos:[2875,2389]},{id:"207",pos:[7420,2451]},{id:"210",pos:[4982,2455]},{id:"211",pos:[3387,2480]},{id:"213",pos:[3707,2480]},{id:"216",pos:[6414,2692]},{id:"219",pos:[4226,2726]},{id:"221",pos:[4674,2726]},{id:"223",pos:[5406,2741]},{id:"227",pos:[6927,2876]},{id:"233",pos:[2164,2914]},{id:"235",pos:[2571,2914]},{id:"237",pos:[147,2944]},{id:"240",pos:[1801,2944]},{id:"245",pos:[4991,2997]},{id:"251",pos:[5409,3114]},{id:"255",pos:[4674,3140]},{id:"257",pos:[2164,3172]},{id:"260",pos:[3632,3177]},{id:"268",pos:[2550,3345]},{id:"270",pos:[2949,3345]},{id:"272",pos:[1801,3377]},{id:"276",pos:[4226,3424]},{id:"279",pos:[7079,3429]},{id:"281",pos:[7396,3429]},{id:"283",pos:[270,3461]},{id:"285",pos:[533,3461]},{id:"289",pos:[4990,3537]},{id:"291",pos:[2550,3618]},{id:"293",pos:[941,3653]},{id:"296",pos:[6006,3705]},{id:"298",pos:[6333,3705]},{id:"303",pos:[119,3818]},{id:"306",pos:[7079,3876]}];Pathways.Infographic=function(){var a=$('[data-component="infographic"] svg');a.on("click","circle",function(){var b=$(this),c=b.position().top,d=b.position().left,e=b.attr("r"),f=d+e/2,g=c+e/2;a.css("transform-origin",f+"px "+g+"px"),a.css("transform","scale(3, 3)")})},Pathways.LibraryPanel=function(){$(".library-panel").on("click",".handle",function(){var a=$(this),b=a.parent();b.hasClass("active")?(b.css("transform","translate("+b.outerWidth()+"px, "+(b.outerHeight()-60)+"px)"),b.removeClass("active")):(b.css("transform","translate(38px, 38px)"),b.addClass("active"),$(window).one("scroll",function(){a.trigger("click")}))})},Pathways.Modal=function(){$(".modal").on("click",function(){var a=new Modal($(this));a.init()})},Pathways.PlayerOverlay=function(a){function b(a){return a=a||0,Pathways.panelHeight-a}function c(a){return a=a||0,window.innerWidth-a}var d=$(a),e=180,f=0,g="body",h=".wellcomePlayer",i="modal-open",j="overlay-fullscreen",k='<div class="close"></div>',l='<div class="overlay"></div>';d.on("click",function(a){function d(){return w?f:e}function m(a,c){y.css("height",b(0)),x.css("width",a),x.css("height",c),Pathways.Utils.positionCenter(x)}function n(){var a=d();m(c(a),b(a))}function o(a,b,c){var d=$(a);return d.append(c),b.append(d),d}function p(a,b){return $el=$(a),b.append($el),$el}function q(a){window.initPlayers($(a))}function r(a,b){a.on("click",function(){$(g).removeClass(i),w=!1,window.embedScriptIncluded=!1,setTimeout(function(){a.remove()},1e3)}),setTimeout(function(){$(g).addClass(i),q(b)},50)}function s(){$(window).resize(n),$(document).bind("onToggleFullScreen",function(a,b){b?(w=!0,y.addClass(j)):(w=!1,y.removeClass(j)),n()})}function t(){var a=$(g);z=$(k),y=o(l,a,z),x=p(C,y),s(),r(y,h)}var u=$(this),v=u.data("embed"),w=!1;if(v){var x,y,z,A=b(e),B=c(e),C='<div class="wellcomePlayer" data-no-load="true" data-uri="'+v+'" data-assetsequenceindex="0" data-assetindex="0" data-zoom="-0.6441,0,2.2881,1.4411" data-config="/service/playerconfig" style="width:'+B+"px; height:"+A+'px; background-color: #000"></div>';return t(),n(),a.preventDefault(),!1}})},Pathways.PlayerOverlay.alwaysLoad=!0,Pathways.Quiz=function(){$("body").on("click",'[data-component="quiz"]',function(){var a=$('<div class="overlay"></div>'),b=$('<div class="close"></div>');a.css("height",window.innerHeight),$("body").append(a),a.show(),a.css({"background-color":"rgba(0,0,0,0.9)","background-image":"url("+quiz_db.images+"/bg.jpg)"}),$("body").addClass("modal-open"),setTimeout(function(){var c=$(_("#template-quiz").innerHTML),d=$('<div class="content"></div>'),e=$('<div class="quiz"></div>');d.append(c),e.append(d),a.append(e),Pathways.Utils.positionCenter(e);new Quiz(e);a.append(b)},800),b.on("click",function(){a.css("opacity",0),$("body").removeClass("modal-open"),setTimeout(function(){a.remove()},800)}),$(window).on("resize",function(){a.css("height",window.innerHeight)})})},Pathways.ToggleSection=function(a){var b=$(a),c=$(b.attr("data-toggle-section-target")),d=$(b.attr("data-toggle-section-anchor")),e=c.height();c.css({height:0,transition:"height 0.4s ease"}),b.on("click",function(){return c.toggleClass("open"),c.hasClass("open")?(c.css("height",e),$("html, body").animate({scrollTop:d.offset().top-100},400)):c.css("height",0),!1})},Pathways.ToggleSection.alwaysLoad=!0,Pathways.Scene.MesmersSalon=function(a){var b=new ScrollScene({triggerElement:a,duration:Pathways.panelHeight-100,offset:100}).on("enter",function(){_(".crop-zoom").style.position="fixed",TweenMax.to(".crop-zoom",.2,{opacity:1})}).on("leave",function(){TweenMax.to(".crop-zoom",.2,{opacity:0}),setTimeout(function(){_(".crop-zoom").style.position="absolute"},200)});Pathways.Scenes.push(b)},Pathways.Scene.MagnetisedTrees=function(a){var b=new ScrollScene({triggerElement:a,duration:Pathways.panelHeight}).on("enter",function(b){"FORWARD"==b.scrollDirection&&(TweenMax.to(a+" .black-strip",.4,{y:0}),createjs.Ticker.addEventListener("tick",stage))}).on("leave",function(b){"REVERSE"==b.scrollDirection&&(TweenMax.to(a+" .black-strip",.2,{y:Pathways.panelHeight}),createjs.Ticker.removeEventListener("tick",stage))});Pathways.Scenes.push(b)},Pathways.Scene.OkeySisters=function(a){$("#okey-sisters .main-content, #okey-sisters .secondary-content").css({bottom:"auto",top:Pathways.panelHeight}),$("#thomas-wakley .main-content").css({bottom:"auto",top:Pathways.panelHeight/3});var b=$(a),c=(b.outerHeight(),new ScrollScene({triggerElement:a,triggerHook:"top",duration:Pathways.panelHeight}).on("enter",function(a){"FORWARD"==a.scrollDirection&&TweenMax.to(".black-strip",.5,{y:0})}).on("leave",function(a){"REVERSE"==a.scrollDirection&&TweenMax.to(".black-strip",.2,{y:Pathways.panelHeight})}));Pathways.Scenes.push(c)},Pathways.Scene.GonadMan=function(a){var b=$(a),c=(b.find('[data-component="quiz"]'),b.outerHeight(),new ScrollScene({triggerElement:a,triggerHook:"top",duration:function(){return b.outerHeight()+.5*Pathways.panelHeight}}).on("enter",function(){b.addClass("active")}).on("leave",function(){b.removeClass("active")}));Pathways.Scenes.push(c)},Pathways.Scene.India=function(a){{var b=$(a),c=b.find(".boats"),d=322/1900,e=d*window.innerWidth;$(a).find(".main-content").outerHeight()+100,b.outerHeight()}c.css({bottom:0,height:e}),$(window).on("resize",function(){e=d*window.innerWidth,c.css({height:e})});var f=new ScrollScene({triggerElement:a,duration:function(){return b.outerHeight()+Pathways.panelHeight/4}}).on("enter",function(){c.css("transition","transform 120s linear"),c.css("transform","translate("+window.innerWidth+"px,0)")}).on("leave",function(){c.css("transition","none"),c.css("transform","translate(-600px,0)")});Pathways.Scenes.push(f)},Pathways.Scene.Trilby=function(){$(".comic-panel").css("opacity",0),$(".comic-panel").each(function(){var a=$(this),b=TweenMax.to(a,1,{opacity:1}),c=a.data("offset")?a.data("offset"):0,d=new ScrollScene({triggerElement:a,duration:200,offset:c}).setTween(b);
Pathways.Scenes.push(d)})},Pathways.Scene.AnnaO=function(a){var b=[{x:-57,y:-107},{x:79,y:32},{x:178,y:178},{x:-144,y:106}],c=0,d=$(a);$(a+" .fragmented").each(function(){var a=$(this),d=b[c].x,e=b[c].y;a.css(Modernizr.csstransforms3d?{transform:"translate3d("+d+"px, "+e+"px, 0)"}:{transform:"translate("+d+"px, "+e+"px)"}),c++}),$(a+" .fragmented").each(function(){var b=TweenMax.to($(this),1,{x:0,y:-3}),c=new ScrollScene({triggerElement:a,triggerHook:"top",duration:function(){return d.height()-400},offset:50}).setTween(b);Pathways.Scenes.push(c)})},Pathways.Scene.Office=function(a){var b=new ScrollScene({triggerElement:a,duration:Pathways.panelHeight}).on("enter",function(b){"FORWARD"==b.scrollDirection&&TweenMax.to(a+" .black-strip",.5,{y:0})}).on("leave",function(b){"REVERSE"==b.scrollDirection&&TweenMax.to(a+" .black-strip",.2,{y:Pathways.panelHeight})});Pathways.Scenes.push(b)},Pathways.Scene.Office2=function(a){var b=$(a),c=b.find(".large-screen").first(),d=new ScrollScene({triggerElement:a,duration:function(){return b.outerHeight()+.5*Pathways.panelHeight},offset:100}).on("enter",function(){console.log("enter couch"),c.css("transition","transform 14s ease"),c.css("transform","translate(-80%, -10%) scale(1.8, 1.8)")}).on("leave",function(){c.css("transition","none"),c.css("transform","translate(0,0) scale(1.6, 1.6)")});Pathways.Scenes.push(d)},Pathways.Scene.JohnTradescant=function(){$(".sliding-panel").css({opacity:0});var a=[-100,100,-100,100,-100,100,-100,100,-100,100,-100,100],b=0;$(".sliding-panel").each(function(){var c=$(this);c.css("transform","translate("+a[b]+"px,0)");var d=TweenMax.to(c,1,{x:0,opacity:1}),e=c.data("offset")?c.data("offset"):0,f=new ScrollScene({triggerElement:c,duration:200,offset:e}).setTween(d);Pathways.Scenes.push(f),b++})},Pathways.Scene.DukeOfBuckingham=function(){function a(){if(window.innerWidth/window.innerHeight>d){var a=window.innerWidth/d,b=a/100*87,c=a-window.innerHeight;e.css({height:b,transform:"translate(0, "+-c+"px)"})}else e.css("height","87%")}var b,c=new ScrollScene({triggerElement:"#duke-of-buckingham",triggerHook:"top",duration:Pathways.panelHeight}).on("enter",function(a){b="FORWARD"==a.scrollDirection?window.scrollY:window.scrollY-(Pathways.panelHeight-100)}).on("progress",function(){$(".pence").css("transform","translate(0, "+(window.scrollY-b)+"px)")});Pathways.Scenes.push(c);var d=1900/1050,e=$("#duke-of-buckingham .clip");a(),window.addEventListener("resize",function(){a()})},Pathways.Scene.UniqueArtifacts=function(){var a=($("#unique-artifacts .bg-container"),TweenMax.to(_("#unique-artifacts .bg-container"),1,{"background-position":"50% -216px"})),b=TweenMax.to(_("#unique-artifacts .crop-zoom"),1,{y:"-216"}),c=new ScrollScene({triggerElement:"#unique-artifacts",duration:Pathways.panelHeight-100,offset:100}).on("enter",function(){_(".crop-zoom").style.position="fixed",TweenMax.to(".crop-zoom",.2,{opacity:1})}).on("leave",function(){TweenMax.to(".crop-zoom",.2,{opacity:0}),setTimeout(function(){_(".crop-zoom").style.position="absolute"},200)}),d=new ScrollScene({triggerElement:"#unique-artifacts",duration:Pathways.panelHeight-100}).setTween(a),e=new ScrollScene({triggerElement:"#unique-artifacts",duration:Pathways.panelHeight-100}).setTween(b);Pathways.Scenes.push(c),Pathways.Scenes.push(d),Pathways.Scenes.push(e)},Pathways.Scene.KenVideo=function(){var a=$("#ken-video"),b=a.find("video").get(0),c=new ScrollScene({triggerElement:a,duration:Pathways.panelHeight+100}).on("enter",function(){b.play()}).on("leave",function(){b.pause(),b.currentTime=0});Pathways.Scenes.push(c)},Pathways.Scene.Example=function(){var a=new ScrollScene({triggerElement:"#example",duration:Pathways.panelHeight,offset:0}).on("enter",function(){}).on("leave",function(){});Pathways.Scenes.push(a)},Pathways.Scene.BillsOfMortality=function(){var a=new ScrollScene({triggerElement:"#bills-of-mortality",triggerHook:"top",duration:Pathways.panelHeight+150}).on("enter",function(){_("#bills-of-mortality video")&&_("#bills-of-mortality video").play()}).on("leave",function(){_("#bills-of-mortality video")&&(_("#bills-of-mortality video").pause(),_("#bills-of-mortality video").currentTime=0)});Pathways.Scenes.push(a)},Pathways.Scene.GrauntRecords=function(){var a=new ScrollScene({triggerElement:"#graunt-records",duration:Pathways.panelHeight}).on("enter",function(){$("#graunt-records").addClass("active")});Pathways.Scenes.push(a)},Pathways.Scene.IsaacNewton=function(){var a=new ScrollScene({triggerElement:"#isaac-newton",duration:Pathways.panelHeight}).on("enter",function(a){"FORWARD"==a.scrollDirection&&TweenMax.to("#isaac-newton .black-strip",.4,{y:0})}).on("leave",function(a){"REVERSE"==a.scrollDirection&&TweenMax.to("#isaac-newton .black-strip",.2,{y:Pathways.panelHeight})});Pathways.Scenes.push(a)},Pathways.Scene.Example=function(){var a=new ScrollScene({triggerElement:"#example",duration:Pathways.panelHeight,offset:0}).on("enter",function(){}).on("leave",function(){});Pathways.Scenes.push(a)},Pathways.Scene.SeizedAndDestroyed=function(){var a=$("#seized-and-destroyed"),b={x:-10,y:-5};a.find(".rubbish div").each(function(){var c=5+20*Math.random(),d={x:b.x*c,y:b.y*c},e=TweenMax.to($(this),1,{x:d.x,y:d.y}),f=new ScrollScene({triggerElement:a,duration:a.outerHeight(),offset:50}).setTween(e);Pathways.Scenes.push(f)})},Pathways.Scene.JosephKhan=function(){var a=new ScrollScene({triggerElement:"#joseph-khan",duration:Pathways.panelHeight+100}).on("enter",function(){var a=_("#joseph-khan video");a.play()}).on("leave",function(){var a=_("#joseph-khan video");a.pause(),a.currentTime=0});Pathways.Scenes.push(a)},Pathways.Scene.BritishMuseum=function(){var a=new ScrollScene({triggerElement:"#british-museum",triggerHook:"top"}).on("enter",function(){$("#british-museum").addClass("active")});Pathways.Scenes.push(a)},Pathways.Scene.Letters=function(){var a=new ScrollScene({triggerElement:"#letters",duration:Pathways.panelHeight}).on("enter",function(){_("#letters audio")&&_("#letters audio").play()}).on("leave",function(){_("#letters audio")&&_("#letters audio").pause()});Pathways.Scenes.push(a)},Pathways.Scene.Example=function(a,b){var c=new ScrollScene({triggerElement:b,duration:Pathways.panelHeight,offset:0}).on("enter",function(){}).on("leave",function(){});Pathways.Scenes.push(c)};